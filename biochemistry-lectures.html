<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Biochemistry - المحاضرات</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-7WSXYQGC2G"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);} 
    gtag('js', new Date());
    gtag('config', 'G-7WSXYQGC2G');
  </script>
  <!-- Network warmup for faster first play -->
  <link rel="preconnect" href="https://www.youtube.com" crossorigin>
  <link rel="preconnect" href="https://i.ytimg.com" crossorigin>
  <link rel="preconnect" href="https://img.youtube.com" crossorigin>
  <link rel="preconnect" href="https://drive.google.com" crossorigin>
  <link rel="dns-prefetch" href="//www.youtube.com">
  <link rel="dns-prefetch" href="//i.ytimg.com">
  <link rel="dns-prefetch" href="//img.youtube.com">
  <link rel="dns-prefetch" href="//drive.google.com">
  <style>
    body { transition: opacity 600ms ease; }
    body.page-enter { opacity: 0; }
    body.page-enter-active { opacity: 1; }
    .nav-anim { position: relative; }
    .nav-anim::after { content: ""; position: absolute; right: 0; bottom: -4px; height: 2px; width: 0; background: rgb(79 70 229); transition: width 300ms ease; }
    .nav-anim:hover::after { width: 100%; }
    .reveal-on-scroll { opacity: 0; transform: translateY(10px); transition: opacity 600ms ease, transform 600ms ease; }
    .reveal-active { opacity: 1; transform: translateY(0); }
    .lecture-item.active .lecture-card { outline: 2px solid rgb(79 70 229); outline-offset: 0; box-shadow: 0 10px 20px rgba(79,70,229,0.12); }
    .lecture-card { transition: transform 220ms ease, box-shadow 220ms ease, outline-color 220ms ease; }
    .lecture-card:hover { transform: translateY(-2px); box-shadow: 0 10px 18px rgba(0,0,0,0.08); }
    .thumb { position: relative; }
    .play-badge { position: absolute; inset-inline-end: 8px; inset-block-end: 8px; background: rgba(0,0,0,0.7); color: white; font-size: 12px; padding: 2px 6px; border-radius: 999px; display: flex; align-items: center; gap: 6px; }
    .play-badge svg { width: 12px; height: 12px; }
    #lectures .lecture-card .p-3 { padding: 0.75rem; }
    #lectures .lecture-card .video-title { font-size: 0.9rem; line-height: 1.3; }
    #lectures.compact .lecture-card .video-title { font-size: 0.8rem; }
    #lectures.compact .lecture-card .p-3 { padding: 0.5rem; }
    #lectures.compact .lecture-card { box-shadow: 0 6px 14px rgba(0,0,0,0.06); }
    .ltr { direction: ltr; text-align: left; }
    @media (max-width: 640px) {
      #lectures.compact { gap: 0.5rem; }
      #lectures.compact .lecture-card { display: grid; grid-template-columns: 96px 1fr; align-items: center; }
      #lectures.compact .lecture-card .thumb { width: 96px; }
      #lectures.compact .lecture-card .thumb .aspect-video { width: 96px; }
      #lectures.compact .lecture-card .p-3 { padding: 0.5rem; }
      #lectures.compact .lecture-card .video-title { font-size: 0.85rem; line-height: 1.2; display: -webkit-box; -webkit-line-clamp: 2; line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
      #lectures.compact .play-badge { display: none; }
    }
  </style>
</head>
<body class="bg-slate-50 text-slate-800 page-enter">
  <header class="bg-white border-b border-slate-200 sticky top-0 z-10">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between relative">
      <a href="index.html" aria-label="العودة للصفحة الرئيسية" class="absolute left-3 top-1/2 -translate-y-1/2 inline-flex items-center">
        <img src="assets/clearmed.png" alt="ClearMed banner" class="h-10 w-auto object-contain"/>
      </a>
      <nav class="flex items-center gap-4 sm:gap-6 absolute right-3 sm:right-4 top-1/2 -translate-y-1/2">
        <a href="biochemistry.html" class="hover:text-indigo-600 nav-anim ltr">Biochemistry</a>
      </nav>
    </div>
  </header>
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 ltr">
    <div class="mb-6 reveal-on-scroll">
      <h1 class="text-2xl font-bold mb-2 ltr">Biochemistry — Lectures</h1>
    </div>
    <!-- Doctor selector removed on this page; selection is controlled from main Biochemistry page -->

    <section id="playerWrap" class="hidden reveal-on-scroll">
      <div id="playerCard" class="rounded-lg border bg-white p-4 max-w-5xl mx-auto">
        <div id="playerFrameWrap" class="aspect-video bg-slate-100 rounded overflow-hidden">
          <iframe id="player" class="w-full h-full" src="" title="Biochemistry Lecture" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading="lazy"></iframe>
        </div>
        <div class="mt-2 flex items-center gap-2">
          <select id="providerSelect" class="grow rounded border px-3 py-2 text-sm">
            <option value="savefrom" selected>SaveFrom</option>
            <option value="ssyoutube">ssYouTube</option>
          </select>
          <button id="downloadBtn" class="rounded-lg bg-emerald-600 text-white px-4 py-2 hover:bg-emerald-700 transition-transform hover:-translate-y-0.5">تحميل</button>
        </div>
        <div id="driveHint" class="mt-3 text-center text-sm text-slate-600 hidden" dir="rtl">
          إذا تأخر التشغيل، <a id="driveHintLink" href="#" target="_blank" rel="noopener" class="text-indigo-700 underline">اضغط هنا</a>
        </div>
      </div>
    </section>
    <section class="space-y-4 reveal-on-scroll">
      <div class="rounded-lg border bg-white">
        <h2 class="px-4 py-4 border-b text-center text-2xl sm:text-3xl font-extrabold tracking-tight" dir="rtl">المحاضرات</h2>
        <ul id="lectures" class="p-3 sm:p-4 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2 compact ltr"></ul>
      </div>
    </section>
  </main>

  <footer class="border-t bg-white mt-10">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 text-sm text-slate-600 text-left">© 2025 clearmed.site</div>
  </footer>

  <script src="assets/js/lectures.js"></script>
  <script>
    // Page enter and reveal + dynamic doctor switching
    document.addEventListener('DOMContentLoaded', () => {
      requestAnimationFrame(() => {
        document.body.classList.add('page-enter-active');
        document.body.classList.remove('page-enter');
      });
      try { document.querySelectorAll('.reveal-on-scroll').forEach(el => el.classList.add('reveal-active')); } catch(_) {}

      const ul = document.getElementById('lectures');

      // Datasets
      const DOCTORS = {
        agha: [
          { type: 'youtube', id: 'tFNRGD3oWSQ', size: 'large' },
          { type: 'drive', id: '1cRydv4f1Q-wNEBbCgoTRQc0QiwOgUB9L' },
          { type: 'drive', id: '1l4Gp7uWlAGH5uhZ4djuwdGelCASGedK0' },
          { type: 'drive', id: '1su1-fXLSZmImT3w0HErfB4be3wsvhioJ' },
          { type: 'drive', id: '1-wSTHFQS43bgA1XtHHo0Fdu_dR8cD_ZT' },
          { type: 'drive', id: '1wwi-Q04R4jwIg2qcMHG59kwRVL0MNzZf' },
          { type: 'drive', id: '17xCVL5JAQX95iClyqPqJOwbxne6_rzf1' },
          { type: 'drive', id: '1nunm5R20TvmwUesvL2vufvFm3T65UqCp' },
          { type: 'drive', id: '1LWy9fuz-PZ2GqU3vogmdTktW8KVWJNWR' },
          { type: 'drive', id: '1fhqkLfbPo6EJOrdSAZDYrU7BOC0ROudN' },
          { type: 'drive', id: '1a7yeEtc82-vmR1fmsjTkVZxdeQOtjF1W' },
          { type: 'drive', id: '1Gt-BKZvrbQYNdyFVH9O8DdSkv2XYZ3UH' },
          { type: 'drive', id: '13SUQWGjJ-hhn_M6GFVhrhGRr-VHX2dGU' },
          { type: 'drive', id: '1L1vv5_AcpuBLnqVR01omtNa6Uh6MeIxQ' },
          { type: 'drive', id: '1fu--NwH8yLKGW2rdWSe8lXMEAm2bXSeu' },
          { type: 'drive', id: '1UWhyq86A3ddv1PE17ThB4lubnYEXQGg9' },
          { type: 'drive', id: '1kjnyEjdAzrL0Q3lBLrcOXzP3PkpAxyi1' },
          { type: 'drive', id: '184wQyOuNo46lHnS7cDaAGHGTiLB6HcQX' },
          { type: 'drive', id: '19JoF2bOL7o1i2C1pFYE5M_i6c9uGQiB7' },
          { type: 'drive', id: '197ubn-QTwrbBli-nLX-FtDJ52erwN-py' },
          { type: 'drive', id: '1F-NvUHXQD3YQ0LD5YfBxKxGYpvncAV3x' }
        ],
        adham: [
          // TODO: سيتم إضافة محاضرات د/ أدهم صالح هنا عند تزويد الروابط
        ]
      };

      function thumbFor(item){
        if (item.type === 'youtube') {
          return `https://img.youtube.com/vi/${item.id}/hqdefault.jpg`;
        }
        return '';
      }

      function renderLectures(docKey){
        const list = DOCTORS[docKey] || [];
        ul.innerHTML = '';
        list.forEach((item) => {
          const li = document.createElement('li');
          li.className = 'lecture-item';
          if (item.type === 'youtube') li.setAttribute('data-video', item.id);
          if (item.type === 'drive') li.setAttribute('data-drive', item.id);
          li.setAttribute('data-size', item.size || 'small');

          const card = document.createElement('div');
          card.className = 'lecture-card rounded-lg border bg-white overflow-hidden cursor-pointer';

          const thumb = document.createElement('div');
          thumb.className = 'thumb aspect-video bg-slate-100 relative overflow-hidden flex items-center justify-center text-slate-500 text-sm';
          const imgSrc = thumbFor(item);
          if (imgSrc) {
            thumb.classList.remove('flex','items-center','justify-center','text-slate-500','text-sm');
            const img = document.createElement('img');
            img.src = imgSrc;
            img.alt = 'Lecture thumbnail';
            img.className = 'w-full h-full object-cover select-none pointer-events-none';
            img.loading = 'lazy';
            img.decoding = 'async';
            thumb.appendChild(img);
          } else {
            thumb.appendChild(document.createTextNode('Google Drive'));
          }
          const badge = document.createElement('div');
          badge.className = 'play-badge';
          badge.innerHTML = '<svg viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"/></svg>تشغيل';
          thumb.appendChild(badge);

          const body = document.createElement('div');
          body.className = 'p-3 text-sm font-medium';
          const span = document.createElement('span');
          span.className = 'video-title ltr';
          span.textContent = 'Lecture';
          body.appendChild(span);

          card.appendChild(thumb);
          card.appendChild(body);
          li.appendChild(card);
          ul.appendChild(li);
        });

        // Initialize player + numbering + overlays
        try { initLectures({ autoTitle: false }); } catch(_) {}

        // Drive hint wiring
        function syncDriveHint(){
          try {
            const hint = document.getElementById('driveHint');
            const link = document.getElementById('driveHintLink');
            if (!hint || !link) return;
            const active = document.querySelector('#lectures li.active');
            if (!active) { hint.classList.add('hidden'); return; }
            const driveId = active.getAttribute('data-drive');
            if (driveId) {
              link.href = `https://drive.google.com/file/d/${driveId}/view`;
              hint.classList.remove('hidden');
            } else {
              hint.classList.add('hidden');
            }
          } catch(_) {}
        }
        ul.querySelectorAll('li').forEach(li => li.addEventListener('click', () => setTimeout(syncDriveHint, 50)));
        setTimeout(syncDriveHint, 200);
      }

      // Persist selection
      const saved = (()=>{ try { return localStorage.getItem('bio_doc') || 'agha'; } catch(_) { return 'agha'; } })();
      renderLectures(saved);

      // Ensure iframe is lazy
      try {
        const iframeEl = document.getElementById('player');
        if (iframeEl) iframeEl.setAttribute('loading', 'lazy');
      } catch(_) {}
    });
    window.addEventListener('pageshow', () => {
      document.body.classList.add('page-enter-active');
      document.body.classList.remove('page-enter');
    });
  </script>
</body>
</html>
