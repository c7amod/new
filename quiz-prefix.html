<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Terminology Quiz — Prefix</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-7WSXYQGC2G"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);} 
    gtag('js', new Date());

    gtag('config', 'G-7WSXYQGC2G');
  </script>
  <style>
    body { transition: opacity 600ms ease; }
    body.page-enter { opacity: 0; }
    body.page-enter-active { opacity: 1; }
    .reveal-on-scroll { opacity: 0; transform: translateY(10px); transition: opacity 600ms ease, transform 600ms ease; }
    .reveal-active { opacity: 1; transform: translateY(0); }
    .nav-anim { position: relative; }
    .nav-anim::after { content: ""; position: absolute; right: 0; bottom: -4px; height: 2px; width: 0; background: rgb(79 70 229); transition: width 300ms ease; }
    .nav-anim:hover::after { width: 100%; }
    .ltr { direction: ltr; text-align: left; }
    .choice { transition: background-color 180ms ease, color 180ms ease, border-color 180ms ease; }
    .choice.correct { background-color: #ecfdf5; border-color: #10b981; }
    .choice.incorrect { background-color: #fef2f2; border-color: #ef4444; }
    /* Top-centered result icon with fixed size */
    #quizContainer [data-qid] { position: relative; }
    .badge { position: absolute; top: 8px; left: 50%; transform: translateX(-50%);
      width: 40px; height: 40px; font-size: 22px; line-height: 1; padding: 0; border-radius: 9999px;
      background: transparent; border: none; display: flex; align-items: center; justify-content: center; }
    .badge-correct { color: #059669; }
    .badge-incorrect { color: #dc2626; }
    @keyframes fadeUp { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
    .card-enter { animation: fadeUp 420ms ease both; }
    .opt-key { width: 1.5rem; display: inline-flex; justify-content: center; font-weight: 600; color: #475569; }
    /* Left position for question number */
    #quizContainer [data-role="num"] { position: absolute; left: 12px; top: 12px; font-weight: 700; }
  </style>
</head>
<body class="bg-slate-50 text-slate-800 page-enter">
  <header class="bg-white border-b border-slate-200 sticky top-0 z-10">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between relative">
      <div class="flex items-center gap-2">
        <a href="index.html" aria-label="العودة للصفحة الرئيسية" class="absolute left-3 md:-left-3 lg:-left-4 top-1/2 -translate-y-1/2 inline-flex items-center">
          <img src="assets/clearmed.png" alt="ClearMed banner" class="h-10 w-auto object-contain"/>
        </a>
      </div>
      <nav class="flex items-center gap-4 sm:gap-6 absolute right-3 sm:right-4 top-1/2 -translate-y-1/2">
        <a href="index.html" class="hover:text-indigo-600 nav-anim">الرئيسية</a>
        <a href="terminology.html#tests" class="hover:text-indigo-600 nav-anim">الاختبارات</a>
      </nav>
    </div>
  </header>

  

  <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="mb-6">
      <h1 class="text-2xl font-bold mb-2 ltr">Prefix</h1>
      <p class="text-slate-700">اختر الإجابة الصحيحة لكل سؤال ثم اضغط "إنهاء الاختبار" لعرض الدرجة ومراجعة الإجابات.</p>
      <div class="mt-2 text-sm text-slate-600">الوقت: <span id="liveTimer">00:00</span></div>
    </div>

    <div id="quizContainer" class="space-y-4"></div>

    <div class="mt-6 flex flex-wrap items-center gap-3">
      <button id="submitBtn" class="rounded-lg bg-indigo-600 text-white px-5 py-2 hover:bg-indigo-700 transition-transform hover:-translate-y-0.5">إنهاء الاختبار</button>
      <button id="retryBtn" class="rounded-lg border px-5 py-2 hover:bg-slate-50 hidden">إعادة المحاولة</button>
      <label class="inline-flex items-center gap-2 text-sm hidden" id="filterWrap">
        <input type="checkbox" id="showOnlyIncorrect" class="rounded border-slate-300" />
        <span>عرض الأسئلة الخاطئة فقط</span>
      </label>
      <div id="scoreBox" class="text-sm text-slate-700 hidden"></div>
      <a href="terminology.html#tests" class="ml-auto rounded-lg border px-5 py-2 hover:bg-slate-50">الرجوع إلى قائمة الاختبارات</a>
    </div>
  </main>

  <footer class="border-t bg-white mt-10">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 text-sm text-slate-600 text-left">© 2025 clearmed.site</div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      requestAnimationFrame(() => {
        document.body.classList.add('page-enter-active');
        document.body.classList.remove('page-enter');
      });
      // Generic quiz start timestamp + remember source page
      try {
        const t = Date.now();
        sessionStorage.setItem('quiz_start', String(t));
        sessionStorage.setItem('quiz_last_source', 'quiz-prefix.html');
      } catch(_) {}
      // Start live timer UI
      try { startLiveTimer(Date.now()); } catch(_) {}
    });
    window.addEventListener('pageshow', () => {
      document.body.classList.add('page-enter-active');
      document.body.classList.remove('page-enter');
    });
    // Back button logic removed: using logo link instead

    // Quiz data (Prefix)
    const questions = [
      { id: 'q1', text: 'Cutline running from up downwards and divides the body into right and left halves:', choices: ['Sagittal', 'Coronal', 'Anterior', 'Transverse'], answer: 0 },
      { id: 'q2', text: 'Back and middle:', choices: ['Posterior/lateral', 'Anterior/medial', 'Posterior/medial', 'Medial/Lateral'], answer: 2 },
      { id: 'q3', text: 'The opposite of "Ventral" is:', choices: ['Lateral', 'Posterior', 'Superior', 'Inferior'], answer: 1 },
      { id: 'q4', text: 'Movement towards the midline is:', choices: ['Adduction', 'Abduction', 'Coronal', 'Sagittal'], answer: 0 },
      { id: 'q5', text: 'Nose is to the ears:', choices: ['Superior', 'Inferior', 'Medial', 'Anterior'], answer: 2 },
      { id: 'q6', text: 'Back and side:', choices: ['Posterior/lateral', 'Anterior/lateral', 'Posterior/medial', 'Medial/Lateral'], answer: 0 },
      { id: 'q7', text: 'Membrane around bones means:', choices: ['Perosteum', 'Periosteum', 'Infraosteum', 'Epiosteum'], answer: 1 },
      { id: 'q8', text: 'It comes at the beginning of the word:', choices: ['Prefix', 'Suffix', 'word root', 'Vowel'], answer: 0 },
      { id: 'q9', text: 'Cut plane divides the body into anterior and posterior:', choices: ['Sagittal', 'Transverse plane', 'Coronal plane', 'Horizontal'], answer: 2 },
      { id: 'q10', text: 'The word "percutaneous" means:', choices: ['Through the cranium.', 'Through the skin', 'Under the cranium', 'Through the bone'], answer: 1 },
      { id: 'q11', text: 'The term for surrounding the mouth:', choices: ['Circumoral', 'Sublingual', 'perlingual', 'Circumocular'], answer: 0 },
      { id: 'q12', text: 'The hip is ........ to the foot.', choices: ['Anterior', 'Distal', 'Proximal', 'Lateral'], answer: 2 },
      { id: 'q13', text: 'The prefix sub means .......... and supra means...........:', choices: ['Below & Right', 'Below & Above', 'Above & Below', 'Below & Left'], answer: 1 },
      { id: 'q14', text: 'The prefix "peri" means:', choices: ['Through', 'Around', 'Inside', 'Below'], answer: 1 },
      { id: 'q15', text: 'The sagittal plane divide the body into upper and lower parts:', choices: ['True', 'False'], answer: 1 },
      { id: 'q16', text: 'The direction of front middle means:', choices: ['Anterolateral', 'Anterosuperior', 'Anteromedial', 'Anteroinferior'], answer: 2 },
      { id: 'q17', text: 'The prefix meta means:', choices: ['Above', 'White', 'After', 'Below'], answer: 2 },
      { id: 'q18', text: 'The knee is ........ to the foot.', choices: ['Anterior', 'Posterior', 'Proximal', 'Distal'], answer: 2 },
      { id: 'q19', text: 'The Prefix that mean below is:', choices: ['Supra', 'Epi', 'infra', 'Peri'], answer: 2 },
      { id: 'q20', text: 'The wrist is ……. to the fingers', choices: ['Proximal', 'Superior', 'Distal', 'Inferior'], answer: 0 },
      { id: 'q21', text: 'Front and top is:', choices: ['Anterosuperior', 'Anterolateral', 'Posteromedial', 'Posterolateral'], answer: 0 },
      { id: 'q22', text: 'The prefixes "Epi" and "Sub" have the same meaning:', choices: ['True', 'False'], answer: 1 },
      { id: 'q23', text: 'Extra uterine means upon the uterus:', choices: ['True', 'False'], answer: 1 },
      { id: 'q24', text: 'Front and side means anterolateral:', choices: ['True', 'False'], answer: 0 },
      { id: 'q25', text: 'Ankle is proximal to the hip:', choices: ['True', 'False'], answer: 1 },
      { id: 'q26', text: 'Dextrocardia means that the heart isn’t in his normal place:', choices: ['True', 'False'], answer: 0 },
      { id: 'q27', text: 'Hand is .... to the shoulder', choices: ['distal', 'Proximal', 'Superior', 'Anterior'], answer: 0 },
      { id: 'q28', text: 'The eyebrow is ……………. to the eye', choices: ['Inferior', 'superior', 'External', 'Medial'], answer: 1 },
      { id: 'q29', text: 'When the arm is brought to the midline this is called:', choices: ['Adduction', 'Abduction', 'Rotation', 'Inversion'], answer: 0 },
      { id: 'q30', text: 'Ribs are …… while vertebrae are ……', choices: ['Posterior, Anterior', 'Superior, Inferior', 'Medial, Lateral', 'Anterior, Posterior'], answer: 3 },
      { id: 'q31', text: 'The Prefix that mean (above) is:', choices: ['Supra', 'Infra', 'Epi', 'Both A & C'], answer: 3 },
      { id: 'q32', text: 'Which of the following has a different meaning than the others:', choices: ['Infra', 'Sub', 'Caudal', 'Retro'], answer: 3 },
      { id: 'q33', text: 'A teenage girl had a motorbike accident and injuried her foot. The wound is .... in relation to knee.', choices: ['proximal', 'distal', 'dorsal', 'inferior'], answer: 1 },
    ];

    function renderQuiz() {
      const wrap = document.getElementById('quizContainer');
      wrap.innerHTML = '';
      const letters = ['A', 'B', 'C', 'D'];
      questions.forEach((q, qi) => {
        const card = document.createElement('div');
        card.className = 'rounded-lg border bg-white p-4 card-enter';
        card.dataset.qid = q.id;
        const head = document.createElement('div');
        head.className = 'flex items-start justify-between gap-3 mb-3';
        head.innerHTML = `<div class="font-semibold"></div><div class="hidden" data-role="badge"></div>`;
        card.appendChild(head);
        const text = document.createElement('div');
        text.className = 'mb-3 ltr';
        text.textContent = `${qi + 1}- ${q.text}`;
        card.appendChild(text);
        const ul = document.createElement('ul');
        ul.className = 'space-y-2';
        q.choices.forEach((c, ci) => {
          const li = document.createElement('li');
          li.innerHTML = `
            <label class="choice flex items-center gap-3 rounded border px-3 py-2 cursor-pointer">
              <input type="radio" name="${q.id}" value="${ci}" class="peer" />
              <span class="opt-key">${letters[ci] || ''}</span>
              <span class="ltr grow">${c}</span>
            </label>`;
          ul.appendChild(li);
        });
        card.appendChild(ul);
        wrap.appendChild(card);
      });
    }

    function collectAnswers() {
      const answers = {};
      questions.forEach(q => {
        const checked = document.querySelector(`input[name="${q.id}"]:checked`);
        answers[q.id] = checked ? parseInt(checked.value, 10) : null;
      });
      return answers;
    }

    function lockQuiz() { document.querySelectorAll('#quizContainer input[type="radio"]').forEach(i=>i.disabled=true); }
    function unlockQuiz() { document.querySelectorAll('#quizContainer input[type="radio"]').forEach(i=>i.disabled=false); }

    // Live timer UI
    let timerInterval = null;
    function startLiveTimer(startTs){
      const el = document.getElementById('liveTimer');
      if (!el) return;
      function render(now){
        const diff = Math.max(0, Math.floor((now - startTs)/1000));
        const m = String(Math.floor(diff/60)).padStart(2,'0');
        const s = String(diff%60).padStart(2,'0');
        el.textContent = `${m}:${s}`;
      }
      render(Date.now());
      timerInterval = setInterval(()=>render(Date.now()), 1000);
    }
    function stopLiveTimer(){ if (timerInterval) { clearInterval(timerInterval); timerInterval = null; } }

    function showResults(answers) {
      let correctCount = 0;
      questions.forEach(q => {
        const selected = answers[q.id];
        const card = document.querySelector(`[data-qid="${q.id}"]`);
        const badge = card.querySelector('[data-role="badge"]');
        badge.classList.remove('hidden');
        const options = card.querySelectorAll('label.choice');
        options.forEach((lab, idx) => {
          lab.classList.remove('correct','incorrect');
          if (idx === q.answer) lab.classList.add('correct');
          if (selected !== null && idx === selected && selected !== q.answer) lab.classList.add('incorrect');
        });
        if (selected === q.answer) { correctCount++; badge.className='badge badge-correct'; badge.textContent='✓'; }
        else { badge.className='badge badge-incorrect'; badge.textContent='✗'; }
      });
      const total = questions.length;
      const score = Math.round((correctCount/total)*100);
      const box = document.getElementById('scoreBox');
      box.classList.remove('hidden');
      box.textContent = `درجتك: ${correctCount} / ${total} (${score}%)`;
      document.getElementById('retryBtn').classList.remove('hidden');
      document.getElementById('filterWrap').classList.remove('hidden');
    }

    function applyIncorrectFilter(onlyIncorrect) {
      questions.forEach(q => {
        const card = document.querySelector(`[data-qid="${q.id}"]`);
        const badge = card.querySelector('[data-role="badge"]');
        const isIncorrect = badge && badge.classList.contains('badge-incorrect');
        card.style.display = onlyIncorrect && !isIncorrect ? 'none' : '';
      });
    }

    function resetQuiz() {
      renderQuiz();
      unlockQuiz();
      const box = document.getElementById('scoreBox');
      box.classList.add('hidden');
      box.textContent = '';
      document.getElementById('retryBtn').classList.add('hidden');
      document.getElementById('filterWrap').classList.add('hidden');
      document.getElementById('showOnlyIncorrect').checked = false;
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Init
    renderQuiz();

    // Events
    document.getElementById('submitBtn').addEventListener('click', () => {
      const answers = collectAnswers();
      lockQuiz();
      stopLiveTimer();
      // Compute score summary
      let correctCount = 0;
      const total = questions.length;
      questions.forEach(q => {
        const checked = document.querySelector(`input[name="${q.id}"]:checked`);
        if (checked && parseInt(checked.value,10) === q.answer) correctCount++;
      });
      const score = Math.round((correctCount/total)*100);
      // Duration
      let durationMs = null;
      try {
        const s = sessionStorage.getItem('quiz_start');
        const started = s ? Number(s) : Date.now();
        durationMs = Date.now() - started;
        sessionStorage.setItem('quiz_end', String(Date.now()));
        sessionStorage.setItem('quiz_last_duration', String(durationMs));
      } catch(_) {}
      // Title
      let title = document.querySelector('h1') ? document.querySelector('h1').innerText.trim() : 'Quiz';
      // Persist payload and answers, redirect
      try {
        const payload = { correctCount, total, score, durationMs, title };
        sessionStorage.setItem('quiz_answers', JSON.stringify(answers));
        sessionStorage.setItem('quiz_payload', JSON.stringify(payload));
      } catch(_) {}
      setTimeout(() => { window.location.href = 'quiz-result.html'; }, 240);
    });
    document.getElementById('retryBtn').addEventListener('click', resetQuiz);
    document.getElementById('showOnlyIncorrect').addEventListener('change', e => applyIncorrectFilter(e.target.checked));

    // Review mode: support returning from results page to highlight answers and filter
    (function maybeReview(){
      try {
        const mode = sessionStorage.getItem('quiz_review');
        const src = sessionStorage.getItem('quiz_last_source');
        if (!mode || src !== 'quiz-prefix.html') return;
        const raw = sessionStorage.getItem('quiz_answers');
        const answers = raw ? JSON.parse(raw) : null;
        if (!answers) return;
        showResults(answers);
        lockQuiz();
        document.getElementById('filterWrap').classList.remove('hidden');
        if (mode === 'incorrect') {
          document.getElementById('showOnlyIncorrect').checked = true;
          applyIncorrectFilter(true);
        }
        // clear review flag so it doesn't auto-apply next visits
        sessionStorage.removeItem('quiz_review');
      } catch(_) {}
    })();
  </script>
</body>
</html>
